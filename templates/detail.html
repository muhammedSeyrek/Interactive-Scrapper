<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Analysis Report #{{ .ID }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root { --bg-dark: #12141c; --bg-panel: #1b1e2b; --text: #e0e6ed; --border: #393939; --accent: #0f62fe; --high: #fa4d56; }
        
        * { box-sizing: border-box; } /* Taşmaları önlemek için kritik */
        
        body { 
            background: var(--bg-dark); 
            color: var(--text); 
            font-family: 'IBM Plex Mono', monospace; 
            margin: 0; 
            padding: 20px; 
            overflow-x: hidden; /* Yatay scrollu engelle */
        }

        .container { 
            width: 100%; 
            max-width: 1200px; 
            margin: 0 auto; 
        }
        
        /* BACK BUTTON - EN ÜSTTE */
        .nav-bar { margin-bottom: 20px; }
        .btn-back { 
            color: var(--text); 
            text-decoration: none; 
            font-size: 13px; 
            display: inline-flex; 
            align-items: center; 
            border: 1px solid var(--border); 
            padding: 8px 15px;
            background: var(--bg-panel);
            transition: 0.2s;
        }
        .btn-back:hover { border-color: var(--accent); color: var(--accent); }

        .header { 
            border-bottom: 1px solid var(--border); 
            padding-bottom: 20px; 
            margin-bottom: 30px; 
            display: flex; 
            flex-wrap: wrap; 
            justify-content: space-between; 
            align-items: center; 
            gap: 15px; 
        }
        
        h1 { margin: 0; font-size: 20px; word-break: break-word; line-height: 1.4; }
        
        .badge { padding: 6px 12px; background: var(--border); font-size: 12px; white-space: nowrap; }
        .high { background: rgba(250, 77, 86, 0.2); color: var(--high); border: 1px solid var(--high); }
        
        .grid { 
            display: grid; 
            grid-template-columns: 1fr 1.5fr; /* Sağ taraf biraz daha geniş */
            gap: 30px; 
        }
        
        .panel { background: var(--bg-panel); border: 1px solid var(--border); padding: 20px; margin-bottom: 20px; overflow: hidden; }
        .panel h3 { margin-top: 0; color: var(--accent); font-size: 13px; text-transform: uppercase; border-bottom: 1px solid var(--border); padding-bottom: 10px; letter-spacing: 1px; }
        
        .screenshot-container { 
            width: 100%; 
            min-height: 200px; 
            background: #000; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            border: 1px solid var(--border); 
        }
        img { max-width: 100%; height: auto; display: block; }
        
        /* RAW CONTENT - Scroll sorununu çözen ayarlar */
        pre { 
            white-space: pre-wrap;       /* Satırları kır */
            word-break: break-all;       /* Uzun kelimeleri zorla kır */
            font-size: 11px; 
            color: #8c9cad; 
            max-height: 500px; 
            overflow-y: auto; 
            background: rgba(0,0,0,0.3); 
            padding: 15px; 
            border: 1px solid var(--border);
        }

        .meta-row { margin-bottom: 10px; font-size: 13px; }
        .meta-label { color: #8c9cad; display: inline-block; width: 80px; }
        .meta-val { color: var(--text); word-break: break-all; }

        @media (max-width: 900px) {
            .grid { grid-template-columns: 1fr; } /* Mobilde tek kolon */
            body { padding: 15px; }
            h1 { font-size: 18px; }
        }
    </style>
</head>
<body>
    <div class="container">
        
        <div class="nav-bar">
            <a href="/" class="btn-back">&larr; BACK TO DASHBOARD</a>
        </div>

        <div class="header">
            <div style="flex: 1;">
                <div style="font-size: 11px; color: #8c9cad; margin-bottom: 5px;">REPORT ID: #{{ .ID }}</div>
                <h1>{{ .Title }}</h1>
            </div>
            <div>
                <span class="badge {{ if ge .CriticalityScore 7 }}high{{ end }}">RISK SCORE: {{ .CriticalityScore }}/10</span>
            </div>
        </div>

        <div class="grid">
            <div class="left-col">
                <div class="panel">
                    <h3>Metadata</h3>
                    <div class="meta-row">
                        <span class="meta-label">URL:</span>
                        <span class="meta-val"><a href="{{ .SourceURL }}" style="color:var(--accent); text-decoration:none;" target="_blank">{{ .SourceURL }}</a></span>
                    </div>
                    <div class="meta-row">
                        <span class="meta-label">DATE:</span>
                        <span class="meta-val">{{ .PublishedDate.Format "2006-01-02 15:04" }}</span>
                    </div>
                    <div class="meta-row">
                        <span class="meta-label">CAT:</span>
                        <span class="meta-val">{{ .Category }}</span>
                    </div>
                </div>

                <div class="panel">
                    <h3>Intelligence Findings</h3>
                    <p style="color: #f1c21b; line-height: 1.6; word-break: break-word; font-size: 13px;">
                        {{ if .Matches }}
                            {{ .Matches }}
                        {{ else }}
                            <span style="color: #555;">No specific entities found.</span>
                        {{ end }}
                    </p>
                </div>
            </div>

            <div class="right-col">
                <div class="panel">
                    <h3>Evidence (Screenshot)</h3>
                    <div class="screenshot-container">
                        {{ if .Screenshot }}
                            <img src="data:image/png;base64,{{ .Screenshot }}" alt="Dark Web Screenshot">
                        {{ else }}
                            <span style="color: #555; font-size: 12px;">No Screenshot Available</span>
                        {{ end }}
                    </div>
                </div>

                <div class="panel">
                    <h3>Raw Content Preview</h3>
                    <pre>{{ .Content }}</pre>
                </div>
            </div>
        </div>
    </div>
</body>
</html>